@using ScanApp.Models.HesHub.DeparturePlans
<MudDialog>
    <DialogContent>
        <MudTextField @bind-Value="Data.Id" OnKeyDown="OnKeyDownPress" />
        <MudTextFieldString @bind-Value="Data.Subject" OnKeyDown="OnKeyDownPress" />
        <SfRecurrenceEditor @bind-Value="Data.RecurrenceRule"></SfRecurrenceEditor>
    </DialogContent>
    
    <DialogActions>
        <MudButton Class="ml-auto" Variant="Variant.Filled" Color="Color.Error" OnClick="Cancel">Cancel</MudButton>
        <MudButton Class="mr-auto" Variant="Variant.Filled" Color="Color.Primary" Disabled="!_success" OnClick="Submit">Submit</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] protected MudDialogInstance MudDialog { get; set; }

    [Parameter]
    public DeparturePlanGuiModel Data { get; set; }

    [Parameter]
    public CurrentAction? CurrentAction { get; set; }

    private bool _success = true;

    public async Task Submit()
    {
        MudDialog.Close(DialogResult.Ok(Data));
    }

    public void Cancel()
    {
        MudDialog.Cancel();
    }

    private void OnKeyDownPress(KeyboardEventArgs args)
    {
        switch (args.Key)
        {
            case "Enter":
                Submit();
                break;

            case "Escape":
                Cancel();
                break;
        }
    }
}
